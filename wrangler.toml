#:schema node_modules/wrangler/config-schema.json
name = "oscar"
main = "src/index.ts"
compatibility_date = "2024-06-05"
compatibility_flags = ["nodejs_compat"]

[env.prd]
routes = [
    { pattern = "oscar.svc.cloudflavor.io", zone_name = "cloudflavor.io", custom_domain = true },
]

[env.prd.vars]
OSCAR_LOG_LEVEL = "info"

[env.stg.vars]
OSCAR_LOG_LEVEL = "debug"

[env.dev.vars]
OSCAR_LOG_LEVEL = "debug"

# NOTE: The staging route config is dynamically generated and added by GitHub Actions.
# The name of the route is XXXX-oscar.stg.oscar.cloudflavor.io the XXXX part is 
# a UUID that is generated by GitHub Actions. This is done to have each request a unique
# route and Cloudflare environment that persists.
